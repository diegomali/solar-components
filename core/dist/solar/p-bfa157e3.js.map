{"version":3,"names":["extendMethod","target","method","extend","original","patchList","push","args","lastResult","patch","bind","this","ComponentBehavior","constructor","component","beforeAttach","native","console","warn","host","remove","disconnectedCallback","Element","prototype","apply","setTimeout","componentDidLoad","attach","detach"],"sources":["./src/utils/lang/extend-method.ts","./src/utils/stencil/component-behavior.ts"],"sourcesContent":["/**\r\n * Extend a method functionality, applying monkeypatch method.\r\n * @link https://www.audero.it/blog/2016/12/05/monkey-patching-javascript/\r\n * @param target The target object.\r\n * @param method The name of the method that will be extended.\r\n * @param extend The method's patch.\r\n */\r\nexport function extendMethod(target: any, method: string, extend: (original: Function, args?: any[]) => any) {\r\n  const original = target[method];\r\n\r\n  target['__' + method + '__patch_list'] = target['__' + method + '__patches'] || [];\r\n  const patchList = target['__' + method + '__patch_list'];\r\n\r\n  patchList.push(extend);\r\n\r\n  target[method] = function(...args) {\r\n    let lastResult;\r\n    for (const patch of patchList) {\r\n      lastResult = patch.bind(this)(original ? original.bind(this) : null, args);\r\n    }\r\n    return lastResult;\r\n  };\r\n}\r\n","import { ComponentInterface } from '@stencil/core';\r\n\r\nimport { extendMethod } from '../lang/extend-method';\r\n\r\n/**\r\n * Represents a Component that implements a Behavior Modification API.\r\n */\r\nexport interface ComponentBase extends ComponentInterface {\r\n  /**\r\n   * The main native nativeElement from the component.\r\n   * @Element\r\n   */\r\n  host: HTMLElement;\r\n\r\n  /**\r\n   * The unload lifecycle hook.\r\n   * Note that Stencil only calls disconnectedCallback if it is declared in the component.\r\n   */\r\n  disconnectedCallback: () => void;\r\n\r\n  /**\r\n   * If this behavior is applied to a native element.\r\n   */\r\n  native?: boolean;\r\n}\r\n\r\n/**\r\n * Represents a Component's Behavior Modification.\r\n */\r\nexport class ComponentBehavior<T extends ComponentBase> {\r\n  /**\r\n   * The internal component that this instance is attached.\r\n   */\r\n  component: T;\r\n\r\n  /**\r\n   * A hook called before the component load.\r\n   */\r\n  beforeAttach?(): Promise<any> | void;\r\n\r\n  /**\r\n   * A hook called after the component load.\r\n   */\r\n  attach?(): Promise<any> | void;\r\n\r\n  /**\r\n   * A hook called before the component destroy.\r\n   */\r\n  detach?(): Promise<any> | void;\r\n\r\n  constructor(component: T) {\r\n    this.component = component;\r\n    if (this.beforeAttach) { this.beforeAttach(); }\r\n\r\n    // Native Elements support\r\n    if (this.component.native) {\r\n      console.warn('Attaching a behavior to a native element', this.component);\r\n      this.component.host.remove = () => {\r\n        this.component.disconnectedCallback();\r\n        Element.prototype.remove.apply(this.component.host);\r\n      };\r\n      setTimeout(() => this.component.componentDidLoad(), 0);\r\n    }\r\n\r\n    extendMethod(this.component, 'componentDidLoad', componentDidLoad => {\r\n      if (componentDidLoad) { componentDidLoad(); }\r\n      if (this.attach) { this.attach(); }\r\n    });\r\n\r\n    extendMethod(this.component, 'disconnectedCallback', disconnectedCallback => {\r\n      if (disconnectedCallback) { disconnectedCallback(); }\r\n      if (this.detach) { this.detach(); }\r\n    });\r\n  }\r\n}\r\n"],"mappings":"SAOgBA,EAAaC,EAAaC,EAAgBC,GACxD,MAAMC,EAAWH,EAAOC,GAExBD,EAAO,KAAOC,EAAS,gBAAkBD,EAAO,KAAOC,EAAS,cAAgB,GAChF,MAAMG,EAAYJ,EAAO,KAAOC,EAAS,gBAEzCG,EAAUC,KAAKH,GAEfF,EAAOC,GAAU,YAAYK,GAC3B,IAAIC,EACJ,IAAK,MAAMC,KAASJ,EAAW,CAC7BG,EAAaC,EAAMC,KAAKC,KAAXF,CAAiBL,EAAWA,EAASM,KAAKC,MAAQ,KAAMJ,E,CAEvE,OAAOC,C,CAEX,C,MCOaI,EAqBXC,YAAYC,GACVH,KAAKG,UAAYA,EACjB,GAAIH,KAAKI,aAAc,CAAEJ,KAAKI,c,CAG9B,GAAIJ,KAAKG,UAAUE,OAAQ,CACzBC,QAAQC,KAAK,2CAA4CP,KAAKG,WAC9DH,KAAKG,UAAUK,KAAKC,OAAS,KAC3BT,KAAKG,UAAUO,uBACfC,QAAQC,UAAUH,OAAOI,MAAMb,KAAKG,UAAUK,KAAK,EAErDM,YAAW,IAAMd,KAAKG,UAAUY,oBAAoB,E,CAGtD1B,EAAaW,KAAKG,UAAW,oBAAoBY,IAC/C,GAAIA,EAAkB,CAAEA,G,CACxB,GAAIf,KAAKgB,OAAQ,CAAEhB,KAAKgB,Q,KAG1B3B,EAAaW,KAAKG,UAAW,wBAAwBO,IACnD,GAAIA,EAAsB,CAAEA,G,CAC5B,GAAIV,KAAKiB,OAAQ,CAAEjB,KAAKiB,Q"}