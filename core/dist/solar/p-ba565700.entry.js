import{r as t,c as e,h as s,H as i,g as l}from"./p-bfc2338d.js";import{a as n,b as a}from"./p-8fff0704.js";import{A as h}from"./p-183f60b9.js";import{c as o,e as r}from"./p-554e1c79.js";import{F as c}from"./p-d228c1a4.js";import{F as d,t as p}from"./p-09dd3509.js";import{B as f}from"./p-05671e06.js";import{D as u}from"./p-da0ddaf0.js";import{A as m}from"./p-d7dbca0e.js";import{e as b,i as _}from"./p-3f38ce48.js";import"./p-bfa157e3.js";import"./p-5fa792ab.js";import"./p-5d5098fe.js";import"./p-fe5b2c7a.js";import"./p-112455b1.js";const g="ac-select{display:flex;position:relative;flex-direction:column}ac-select>[slot=item-top],ac-select>[slot=item-bottom]{display:none !important}ac-select .ac-select__helper-text{display:block;margin-top:8px;color:var(--color-neutral-darker, #646464);font-size:12px}ac-select .ac-select__native,ac-select .ac-select__phantom-dom{display:none}ac-select.form-field--invalid .ac-select__helper-text{color:var(--color-alert-normal, #F0000A)}ul.ac-select__list::-webkit-scrollbar{width:8px;height:8px}ul.ac-select__list::-webkit-scrollbar-track{background:rgba(var(--color-theme-contrast-rgb, 17, 17, 17), 0.2)}ul.ac-select__list::-webkit-scrollbar-thumb{background:rgba(var(--color-theme-contrast-rgb, 17, 17, 17), 0.3)}ul.ac-select__list::-webkit-scrollbar-thumb:hover{background:rgba(var(--color-theme-contrast-rgb, 17, 17, 17), 0.4)}";var y=undefined&&undefined.__decorate||function(t,e,s,i){var l=arguments.length,n=l<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,s):i,a;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(t,e,s,i);else for(var h=t.length-1;h>=0;h--)if(a=t[h])n=(l<3?a(n):l>3?a(e,s,n):a(e,s))||n;return l>3&&n&&Object.defineProperty(e,s,n),n};const v=class{constructor(s){t(this,s);this.selectChange=e(this,"selectChange",7);this.SelectPanel=o(r("ac-panel-controller"));this.focusBehavior=new c(this);this.formFieldBehavior=new d(this);this.asyncDataBehavior=new h(this);this.label=undefined;this.helperText=undefined;this.loading=undefined;this.fetch=undefined;this.error=undefined;this.validator=undefined;this.validity=undefined;this.options=undefined;this.value=undefined;this.name=undefined;this.multiple=undefined;this.disabled=undefined;this.searchable=undefined;this.noResultsLabel="No results for";this.searchHelperLabel="Use the field to search";this.required=undefined;this.size=undefined;this.isShowingPanel=undefined;this.selectedText=undefined;this.filteredOptions=undefined;this.filter=undefined}valueDidUpdate(t,e){if(!b(t,[])&&!b(t,e)){this.formatSelectedText()}}optionsDidUpdate(t,e){if(t){const s=t.filter((t=>t.selected));if(s.length>0){const t=s.map((t=>t.value));this.value=this.multiple?t:t[0]}else{this.value=!e?this.value:null}}this.formatSelectedText()}isShowingPanelDidUpdate(){if(this.options.length===0){this.selectedText=null}this.hasFocus=this.isShowingPanel}errorDidUpdate(t){if(t){this.acInputBase.error=true;this.formFieldBehavior.setInvalid()}else{this.acInputBase.error=false;this.formFieldBehavior.setValid()}}filterDidUpdate(){if(this.filter){if(this.fetch){this.asyncDataBehavior.executeFetch()}else{this.filteredOptions=this.options.filter((t=>t.title.toLowerCase().indexOf(this.filter.toLowerCase())>-1))}}else{this.filteredOptions=null}}async getNativeFormField(){return this.nativeSelect}async getSelectedOptions(){return this.getOptionsByValue(this.value)}async setValue(t){this.value=t;this.requestCheckValidity=true;this.formFieldBehavior.setDirty();if(t instanceof Array){this.options.forEach((e=>{e.selected=t.includes(e.value)}))}else{this.options.forEach((e=>{e.selected=t===e.value}))}this.options=[...this.options]}async setInitialOption(t){const e=p(t);this.options=e.map((t=>Object.assign(Object.assign({},t),{selected:true})))}async getFormFieldBehavior(){return this.formFieldBehavior}whenBlur(t){if(!this.selectPanel.contains(t)){if(this.isShowingPanel){this.togglePanel()}this.formFieldBehavior.setTouched()}}whenReceiveData(t){this.filteredOptions=t.data;this.options=t.data}getFetchParams(){return{filter:this.filter}}componentDidLoad(){if(!this.options){this.loadOptionsFromHTML()}else{this.optionsDidUpdate(this.options,null)}}disconnectedCallback(){this.closePanel()}componentDidUpdate(){this.nativeSelect.value=this.value?this.nativeSelect.value:"";if(this.requestCheckValidity){this.formFieldBehavior.checkValidity(this.value);this.requestCheckValidity=false;this.selectChange.emit(this.value)}}getOptionsByValue(t){const e=[];if(this.options&&t){if(t instanceof Array){this.options.forEach((s=>{if(t.includes(s.value)){e.push(s)}}))}else{this.options.forEach((s=>{if(t===s.value){e.push(s)}}))}}return e}formatSelectedText(){const t=this.getOptionsByValue(this.value);if(this.options){const e=t.length;const s=this.options.filter((t=>!t.separator)).length;if(e>0&&e<3){this.selectedText=t.map((t=>t.title)).join(", ")}else if(e>2&&e<s){this.selectedText=`${e} ${this.label}`}else if(e===s&&e!==0){this.selectedText=`Todos (${e})`}}}loadOptionsFromHTML(){const t=this.host.querySelectorAll("option, optgroup");const e=Array.prototype.map.call(t,(t=>({title:t.tagName==="OPTGROUP"?t.label:t.text,value:t.value,selected:t.hasAttribute("selected")&&t.selected,separator:t.tagName==="OPTGROUP",group:t.parentElement.tagName==="OPTGROUP"?t.parentElement.label:null})));if(e.length>0){this.options=e}}renderNativeOptions(){const t=this.value?this.value instanceof Array?this.value:[this.value]:[];return this.options.map((e=>{if(!e.separator){return s("option",{selected:t.includes(e.value),value:e.value},e.title)}}))}renderOptions(t){if(!t){if(this.searchable){return s("li",{class:"ac-list__helper-item"},this.searchHelperLabel)}return null}if(t.length>0){return t.map((t=>{if(t.separator){return s("li",{class:"ac-list__separator"},s("span",{class:"ac-list__separator-title"},t.title),s("span",{class:"ac-list__separator-line"}))}else{return s("li",{class:"ac-list__item "+(t.selected?"ac-list__item--selected":""),onClick:()=>this.handleSelect(t)},t.title)}}))}else{return s("li",{class:"ac-list__helper-item"},this.noResultsLabel," ",this.filter)}}togglePanel(){if(!this.loading&&!this.isShowingPanel){this.acInputBase.setFocus()}else{this.closePanel()}}openPanel(){this.isShowingPanel=true}closePanel(){this.isShowingPanel=false}handleSelect(t){const e=this.options.findIndex((e=>e.value===t.value));if(this.multiple){this.options[e].selected=!t.selected}else{if(!t.selected){this.options.forEach(((t,s)=>{t.selected=s===e}))}}this.options=[...this.options];this.isShowingPanel=this.multiple;this.requestCheckValidity=true;this.formFieldBehavior.setDirty();this.filter=null}async handleDebouncedKeyUp(){const t=await this.acInputBase.getNativeInput();this.filter=t.value}async handleChangeInput(){const t=await this.acInputBase.getNativeInput();if(_(t.value)){this.options=[]}}render(){const t=this.isShowingPanel?n:a;const e=this.SelectPanel;const l=this.filteredOptions||this.options;return s(i,null,s("div",{class:"ac-select__phantom-dom"},s("slot",null)),s("select",{ref:t=>this.nativeSelect=t,name:this.name,multiple:this.multiple,disabled:this.disabled,class:"ac-select__native","data-native":true},this.options&&this.renderNativeOptions()),s("ac-input-base",{ref:t=>{this.acInputBase=t},label:this.label,type:"text",required:this.required,value:this.selectedText,onFocus:this.openPanel,onChange:this.handleChangeInput,disabled:this.disabled,readonly:!this.searchable,onKeyUp:this.searchable?this.handleDebouncedKeyUp:null,size:this.size},s("slot",{name:"item-start",slot:"item-start"}),s("slot",{name:"input-label",slot:"input-label"}),s("ac-button",{slot:"item-end",theme:this.isShowingPanel?"primary":"light",fill:"flat",disabled:this.disabled,loading:this.loading,onClick:this.togglePanel,"icon-only":true},s(m,{icon:t,size:12}))),this.error&&typeof this.error==="string"||this.helperText&&typeof this.helperText==="string"?s("span",{class:"ac-select__helper-text"},this.error||this.helperText):null,s(e,{ref:t=>this.selectPanel=t,class:"ac-select__panel",popperPivot:this.host,reset:!this.isShowingPanel},s("slot",{name:"item-top",slot:"item-top"}),s("ul",{class:"ac-select__list ac-list",style:{maxHeight:v.MAX_ITEMS_TO_RENDER*v.ITEM_HEIGHT+"px"}},this.renderOptions(l)),s("slot",{name:"item-bottom",slot:"item-bottom"})))}get host(){return l(this)}static get watchers(){return{value:["valueDidUpdate"],options:["optionsDidUpdate"],isShowingPanel:["isShowingPanelDidUpdate"],error:["errorDidUpdate"],filter:["filterDidUpdate"]}}};v.MAX_ITEMS_TO_RENDER=10;v.ITEM_HEIGHT=30;y([f],v.prototype,"togglePanel",null);y([f],v.prototype,"openPanel",null);y([f],v.prototype,"closePanel",null);y([f],v.prototype,"handleSelect",null);y([f,u(200)],v.prototype,"handleDebouncedKeyUp",null);y([f],v.prototype,"handleChangeInput",null);v.style=g;export{v as ac_select};
//# sourceMappingURL=p-ba565700.entry.js.map